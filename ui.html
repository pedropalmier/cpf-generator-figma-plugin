<!-- Standard link tag-->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/thomas-lowry/figma-plugin-ds/dist/figma-plugin-ds.css">

<style>
  body,
  html {
    margin: 0;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    gap: 4px;
  }

  .textbox-gray {
    display: flex;
    width: 128px;
    height: 32px;
    padding: 8px;
    justify-content: center;
    align-items: center;
    border-radius: 4px;
    background: #F3F3F3;
  }

  .icon--swap {
    cursor: pointer;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .icon--swap:hover {
    background-color: #F3F3F3;
    border-radius: 4px;
  }

  .icon--swap:active {
    background-color: #D7D7D7;
    border-radius: 4px;
  }
</style>

<div class="textbox-gray" id="textbox">
  <div class="type type--xlarge" id="cpf-display">12345678900</div>
</div>

<div class="icon icon--swap" id="btn-generate"></div>

<script>
  function generateCPF() {
    // Generate 9 random digits
    let cpf = '';
    for (let i = 0; i < 9; i++) {
      cpf += Math.floor(Math.random() * 10);
    }

    // Calculate first verification digit
    let sum = 0;
    for (let i = 0; i < 9; i++) {
      sum += parseInt(cpf.charAt(i)) * (10 - i);
    }
    let remainder = sum % 11;
    let digit1 = remainder < 2 ? 0 : 11 - remainder;
    cpf += digit1;

    // Calculate second verification digit
    sum = 0;
    for (let i = 0; i < 10; i++) {
      sum += parseInt(cpf.charAt(i)) * (11 - i);
    }
    remainder = sum % 11;
    let digit2 = remainder < 2 ? 0 : 11 - remainder;
    cpf += digit2;

    // Return without formatting (11 sequential digits)
    return cpf;
  }

  function displayNewCPF() {
    const generatedCPF = generateCPF();
    document.getElementById('cpf-display').textContent = generatedCPF;
  }

  // Event listeners
  document.getElementById('btn-generate').addEventListener('click', displayNewCPF);


  // Generate CPF on load
  displayNewCPF();
</script>